@page "/author/newpost"
@layout ReaderLayout
@using MudBlazor
@inject NavigationManager NavManager
@using BlogApp1.Client.Services
@using BlogApp1.Shared
@using BSService.Services
@inject BlogService BlogService
<MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="allblogs-container">
    <MudPaper Elevation="8" Class="allblogs-shell">
        <!-- Header -->
        <div class="allblogs-header">
            <div>
                <MudText Typo="Typo.h4" Class="allblogs-title">
                    Your Story Begins Here
                </MudText>
                <MudText Typo="Typo.body2" Class="allblogs-subtitle">
                    Turn your thoughts into words and publish your voice.
                </MudText>
            </div>
        </div>
        <p class="mb-8 text-gray-600">
            Decide your creative path — write it yourself or let AI assist you.
        </p>

        <MudGrid Justify="Justify.Center" Spacing="3">
            <MudItem xs="12" sm="6">
                <MudCard Style="background: rgba(193, 188, 214,0.3);" Class="cursor-pointer hover:shadow-xl transition-all" @onclick="GoToManualWrite">
                    <MudCardContent>
                        <MudIcon Icon="@Icons.Material.Filled.EditNote" Size="Size.Large" Color="Color.Primary" />
                        <h4 class="mt-3 font-medium">Write Manually</h4>
                        <p class="text-sm text-gray-600">Start writing your blog the classic way.</p>
                    </MudCardContent>
                </MudCard>
            </MudItem>

            <MudItem xs="12" sm="6">
                <MudCard Style="background: rgba(193, 188, 214,0.3);" Class="cursor-pointer hover:shadow-xl transition-all" @onclick="GoToAIGenerate">
                    <MudCardContent>
                        <MudIcon Icon="@Icons.Material.Filled.AutoAwesome" Size="Size.Large" Color="Color.Secondary" />
                        <h4 class="mt-3 font-medium">Generate with AI</h4>
                        <p class="text-sm text-gray-600">Give a topic and let AI draft your blog.</p>
                    </MudCardContent>
                </MudCard>
            </MudItem>
        </MudGrid>
        <MudPaper Elevation="1" Class="pa-4 mt-3" Style="background: rgba(193, 188, 214,0.3);">
            <MudStack Direction="Row" Justify="Justify.SpaceBetween" AlignItems="AlignItems.Start" Class="mb-2 creation-header">
                <MudText Typo="Typo.h6" Class="allblogs-title">Your Creations</MudText>
                <MudText Typo="Typo.subtitle2" class="allblogs-subtitle">
                    
                    A collection of @($"{Blogs?.Count() ?? 0} total") blogs you’ve authored.
                </MudText>
            </MudStack>
            <div class="table-wrapper">
                <MudTable Items="Blogs"
                      Hover="true"
                      Dense="true"
                      Elevation="0"
                      Breakpoint="Breakpoint.Sm"
                      Class="allblogs-table">
                <HeaderContent>
                    <MudTh>Title</MudTh>
                    <MudTh>Status</MudTh>
                    <MudTh>Domain</MudTh>
                    <MudTh>Views</MudTh>
                    <MudTh>Reviewed</MudTh>
                    <MudTh class="text-right">Action</MudTh>
                </HeaderContent>
                <RowTemplate>
                    <MudTd>@context.Title</MudTd>
                    <MudTd>
                        <MudChip T="string"
                                 Color="@GetStatusColor(context.Status)"
                                 Size="Size.Small"
                                 Variant="Variant.Filled">
                            @(string.IsNullOrWhiteSpace(context.Status) ? "Unknown" : context.Status)
                        </MudChip>
                    </MudTd>
                    <MudTd>@context.Domain</MudTd>
                    <MudTd>@context.ViewCount</MudTd>
                    <MudTd>@context.ReviewedAt?.ToLocalTime().ToString("dd MMM yyyy")</MudTd>
                    <MudTd Class="text-right">
                        <MudButton Variant="Variant.Outlined"
                                   Color="Color.Primary"
                                   Size="Size.Small"
                                   OnClick="@(() => GoToBlog(context.Slug))">
                            Open
                        </MudButton>
                    </MudTd>
                </RowTemplate>

                <NoRecordsContent>
                    <MudText Typo="Typo.body2" Class="pa-4">
                        blogs found for this author.
                    </MudText>
                </NoRecordsContent>
                </MudTable>
            </div>
        </MudPaper>
    </MudPaper>
</MudContainer>

@code {
    private void GoToManualWrite() => NavManager.NavigateTo("/author/write/story");
    private void GoToAIGenerate() => NavManager.NavigateTo("/author/write/ai");
    private List<BlogDto>? Blogs;
    private void GoToBlog(string slug)
    {
        NavManager.NavigateTo($"/author/blog/{slug}");
    }
    protected override async Task OnInitializedAsync()
    {
        Blogs = await BlogService.GetBlogsByAuthorAsync();
    }
    private Color GetStatusColor(string? status)
    {
        if (string.IsNullOrWhiteSpace(status))
            return Color.Default;

        return status.ToLower() switch
        {
            "pending" => Color.Warning,
            "approved" => Color.Success,
            "rejected" => Color.Error,
            "revise" => Color.Info,
            "draft" => Color.Secondary,
            _ => Color.Default
        };
    }
}
<style>
    /* ========================= */
    /* 🌈 Background */
    /* ========================= */

    body {
        background: linear-gradient(to bottom, #ffffff, #ede9ff);
        margin: 0;
        padding: 0;
    }

    /* ========================= */
    /* 📦 Layout */
    /* ========================= */

    .allblogs-container {
        margin-top: 24px;
        margin-bottom: 24px;
        min-height: 90vh;
        padding: 0 16px;
        font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    .allblogs-shell {
        padding: 24px 28px;
        border-radius: 24px;
        background: rgba(233, 230, 245,0.4);
        box-shadow: 0 24px 40px rgba(15, 23, 42, 0.12), 0 0 0 1px rgba(148, 163, 184, 0.12);
    }

    /* ========================= */
    /* 🧾 Header */
    /* ========================= */

    .allblogs-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
        flex-wrap: wrap;
        gap: 12px;
    }

    .allblogs-title {
        font-weight: 600;
        color: #111827;
    }

    .allblogs-subtitle {
        color: #6B7280;
    }

    /* ========================= */
    /* 📊 Table */
    /* ========================= */

    .table-wrapper {
        width: 100%;
        overflow-x: auto;
    }

    .allblogs-table,
    .allblogs-table * {
        font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

        .allblogs-table .mud-table-head {
            background-color: #a8a5cf;
        }

            .allblogs-table .mud-table-head th {
                font-weight: 600;
                color: #111827;
            }

        .allblogs-table .mud-table-body .mud-table-row:hover {
            background-color: rgba(99, 102, 241, 0.04);
            cursor: pointer;
        }

        /* Improve action button spacing */
        .allblogs-table .mud-button {
            min-width: 70px;
        }

    /* ========================= */
    /* 📱 Tablet */
    /* ========================= */

    @@media (max-width: 960px) {
        .allblogs-shell

    {
        padding: 20px;
        border-radius: 18px;
    }

    .creation-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
    }

    }

    /* ========================= */
    /* 📲 Mobile */
    /* ========================= */

    @@media (max-width: 600px) {
        .allblogs-shell

    {
        padding: 16px;
        border-radius: 16px;
    }

    .allblogs-title {
        font-size: 1.4rem;
    }

    .allblogs-subtitle {
        font-size: 0.9rem;
    }

    /* Make table stacked cards cleaner */
    .mud-table {
        font-size: 0.85rem;
    }

    .mud-chip {
        font-size: 0.7rem !important;
    }

    .mud-button {
        font-size: 0.7rem !important;
        padding: 4px 8px !important;
    }

    }
</style>